using FluentMigrator;

namespace afmr.data.schemaMigration.Migrations
{
	[Migration(202010071340, TransactionBehavior.None)]
	public class M202010071340_AlterVendorCreateSustainmentId : Migration
	{
		private string tableName = "Vendor";

		public override void Up()
		{
			Alter.Table(tableName).AddColumn("SustainmentId").AsString(128).Nullable();
			Execute.Sql(sqlUpdateDunsId);
			Execute.Sql(sqlUpdateVendor);
		}

		public override void Down()
		{
			Delete.Column("SustainmentId").FromTable(tableName);
		}

		private string sqlUpdateDunsId = @"update Vendor set DUNSId = (replicate('0', 9 - len(DUNSId)) + DUNSId) where LEN(DUNSId) < 9";

		private string sqlUpdateVendor = @"
IF NULL != (select OBJECT_ID('Vendor2')) BEGIN

update v1 set 
v1.Name = v2.Name, 
v1.CAGECode = v2.CAGECode,
v1.DUNSId = v2.DUNSId,
v1.AddressLine1 = v2.AddressLine1,
v1.AddressLine2 = v2.AddressLine2,
v1.City = v2.City,
v1.StateAbbreviation = v2.StateAbbreviation,
v1.PostalCode = v2.PostalCode,
v1.SustainmentId = v2.SustainmentId
from Vendor v1
join Vendor2 v2 on v1.DUNSId = v2.DUNSId

insert into Vendor
select v2.Name, v2.CAGECode, v2.DUNSId, null, v2.AddressLine1, v2.AddressLine2, v2.City, v2.StateAbbreviation, v2.PostalCode, null, null, v2.SustainmentId
from Vendor2 v2
left join Vendor v1 on v2.DUNSId = v1.DUNSId
where v1.Id is null

END ELSE BEGIN
update v1 set 
v1.Name = v2.Name, 
v1.CAGECode = v2.CAGECode,
v1.DUNSId = v2.DUNSId,
v1.AddressLine1 = v2.AddressLine1,
v1.AddressLine2 = v2.AddressLine2,
v1.City = v2.City,
v1.StateAbbreviation = v2.StateAbbreviation,
v1.PostalCode = v2.PostalCode,
v1.SustainmentId = v2.SustainmentId
from Vendor v1
join (
select '001063390' as SustainmentId,'APPLETON GRP LLC' as Name,'58YU7' as CAGECode,'001063390' as DUNSId,'9810 E 42ND ST, STE 102' as AddressLine1,'' as AddressLine2,'TULSA' as City,'OK' as StateAbbreviation,'74146' as PostalCode
union all select '007221377','EBSCO SPRING CO. INC.','2K242','007221377','4949 S 83RD E AVE','','TULSA','OK','74145'
union all select '007228562','ORIZON AEROSTRUCTURES - GROVE, INC.','4Y930','007228562','500 INDUSTRIAL RD','','GROVE','OK','74344'
union all select '008244139','B & C MACHINE COMPANY, INC.','22383','008244139','8301 SW 3RD ST','','OKLAHOMA CITY','OK','73128'
union all select '007245087','P-T COUPLING COMPANY','33813','007245087','1414 E WILLOW RD','','ENID','OK','73701'
union all select '027662626','PRO-FAB, LLC','0BT76','027662626','910 N MORGAN RD','','OKLAHOMA CITY','OK','73127'
union all select '033012709','BRADFORD INDUSTRIAL SUPPLY CORP','3F064','033012709','120 E HILL ST','','OKLAHOMA CITY','OK','73105'
union all select '058080110','ACME ENVIRONMENTAL, INC','54400','058080110','2666 N DARLINGTON AVE 66','','TULSA','OK','74115'
union all select '061630554','CHEROKEE NATION INDUSTRIES, LLC','2R431','061630554','ROUTE 3 BOX 498','','STILWELL','OK','74960'
union all select '064544224','ACCURUS AEROSPACE TULSA, LLC','65462','064544224','12716 E PINE ST','','TULSA','OK','74116'
union all select '080252469','M&M PRECISION COMPONENTS, LLC','0DZM8','080252469','13914 E ADMIRAL PL STE A','','TULSA','OK','74116'
union all select '082558107','DELCO DIESEL SERVICES, INC.','0H1R1','082558107','1100 S AGNEW AVE','','OKLAHOMA CITY','OK','73108'
union all select '122592835','MOTION INDUSTRIES, INC.','0JP77','122592835','4116 WILL ROGERS PKWY STE 800','','OKLAHOMA CITY','OK','73108'
union all select '948829692','GREEN COUNTRY AIRCRAFT EXHAUST INC','1GZY9','948829692','1876 N 106 E AVE','','TULSA','OK','74116'
union all select '194399259','GUNNEBO JOHNSON CORPORATION','99557','194399259','1240 N HARVARD AVE','','TULSA','OK','74115'
union all select '105889752','KIRBY - SMITH MACHINERY, INC.','','105889752','6715 W RENO AVE','','OKLAHOMA CITY','OK','731276590'
union all select '116211835','L-3 COMMUNICATIONS WESTWOOD CORPORATION','','116211835','12402 E 60TH ST','','TULSA','OK','741466920'
union all select '116337846','L-3 COMMUNICATIONS WESTWOOD CORPORATION','','116337846','12402 E 60TH ST','','TULSA','OK','741466920'
union all select '119060887','AERO-TEC INDUSTRIES INC','','119060887','11990 NS 356 (HWY 99 N)','','SEMINOLE','OK','748680000'
union all select '126790828','CARTER AEROSPACE MANUFACTURING COMPANY LLC','','126790828','901 S JOHN ZINK AVE','','SKIATOOK','OK','740701047'
union all select '128817546','MAVERICK TECHNOLOGIES, LLC','','128817546','2800 S PURDUE DR','','OKLAHOMA CITY','OK','731285803'
union all select '013719166','CHANDLER INSTRUMENTS COMPANY L.L.C.','','013719166','2001 N INDIANWOOD AVE','','BROKEN ARROW','OK','740121163'
union all select '013807144','LIMCO AIREPAIR INC','','013807144','5304 S LAWTON AVE','','TULSA','OK','741070000'
union all select '148317472','NORDAM GROUP, INC., THE','','148317472','11200 E PINE ST','','TULSA','OK','741161613'
union all select '154120570','PETROLAB, L.L.C.','','154120570','2001 N INDIANWOOD AVE','','BROKEN ARROW','OK','740121163'
union all select '156239550','ALL AMERICAN EAR MOLD LABORATORIES INC','','156239550','625 ENTERPRISE DR STE 160','','EDMOND','OK','730133762'
union all select '156893695','PD-RX PHARMACEUTICALS INC,','','156893695','727 N ANN ARBOR AVE','','OKLAHOMA CITY','OK','731275822'
union all select '161521612','BS&B SAFETY SYSTEMS, L.L.C.','','161521612','7455 E 46TH','','TULSA','OK','741456301'
union all select '178233086','FLIGHTSAFETY INTERNATIONAL INC.','','178233086','700 N 9TH ST','','BROKEN ARROW','OK','740121123'
union all select '181118738','ALKO ENTERPRISES, INC.','','181118738','7416 N BROADWAY EXT STE H','','OKLAHOMA CITY','OK','731169066'
union all select '018499934','ECRC INC','','018499934','4153 MERIDIAN RD','','ARDMORE','OK','734018767'
union all select '021661699','PECOFACET (OKLAHOMA) LLC','','021661699','5935 S 129TH E AVE STE A','','TULSA','OK','741340000'
union all select '002226780','IAQS INC','','002226780','3709 S MISSOURI AVE','','OKLAHOMA CITY','OK','731297937'
union all select '031344984','BATTERIES SOONER INCORPORATED','','031344984','7500 SOUTH SANTA FE AVE','SUITE 200','OKLAHOMA CITY','OK','731398000'
union all select '033016536','CITY CARBONIC LLC','','033016536','406 SW 4TH ST','','OKLAHOMA CITY','OK','731095306'
union all select '033026204','GRAYBAR ELECTRIC COMPANY, INC.','','033026204','103 NE 44TH ST','','OKLAHOMA CITY','OK','731052004'
union all select '033107640','HYDRA SERVICE INC','','033107640','12332 E 1ST ST','','TULSA','OK','741282419'
union all select '033121641','BERENDSEN FLUID POWER INC','','033121641','401 S BOSTON AVE STE 1200','','TULSA','OK','741034019'
union all select '360674337','L-3 COMMUNICATIONS WESTWOOD CORPORATION','','360674337','12402 E 60TH ST','','TULSA','OK','741466920'
union all select '361560576','CND, L.L.C.','','361560576','HWY 51 W','','STILWELL','OK','749609555'
union all select '038322483','OKLAHOMA SAFETY EQUIPMENT COMPANY, INC.','64055','038322483','1701 W TACOMA ST','','BROKEN ARROW','OK','740121449'
union all select '038322814','HELICOMB INTERNATIONAL, INC.','','038322814','1402 S 69TH EAST AVE','','TULSA','OK','741126610'
union all select '038552647','ARCHER TECHNOLOGIES INTERNATIONAL, INCORPORATED','','038552647','45308 HARDESTY RD','','SHAWNEE','OK','748019689'
union all select '044371474','C M P CORPORATION','','044371474','4101 SE 85TH ST','','OKLAHOMA CITY','OK','731356325'
union all select '047994686','APPLIED INDUSTRIAL TECHNOLOGIES, INC.','6L483','047994686','1623 SE 23RD ST','','OKLAHOMA CITY','OK','731297662'
union all select '005086491','CARLISLE FOODSERVICE PRODUCTS, INCORPORATED','','005086491','4711 E HEFNER RD','','OKLAHOMA CITY','OK','731316114'
union all select '050909480','ENVIRO SYSTEMS, INC.','','050909480','12037 N HWY 99','','SEMINOLE','OK','748685402'
union all select '051645935','ELECTRO ENTERPRISES, INC.','','051645935','3601 N I 35 SERVICE RD','','OKLAHOMA CITY','OK','731114412'
union all select '051922888','AUTOQUIP CORPORATION','12458','051922888','1058 W INDUSTRIAL AVE','','GUTHRIE','OK','730446024'
union all select '052853876','AERO COMPONENTS, INC.','','052853876','535 SE 82ND ST','','OKLAHOMA CITY','OK','731492926'
union all select '054586854','NECO INDUSTRIES, INC.','','054586854','3345 S ANN ARBOR AVE','','OKLAHOMA CITY','OK','731797619'
union all select '054989991','MALONE''S CNC MACHINING, INC.','2V045','054989991','2015 E INDUSTRIAL 5 RD','','GROVE','OK','743444101'
union all select '556962611','OAI ELECTRONICS, LLC','','556962611','6960 E 12TH ST','','TULSA','OK','741125619'
union all select '059634709','LAMAR ENTERPRISES, INC.','','059634709','4300 W RIVER PARK DR','','OKLAHOMA CITY','OK','731081730'
union all select '060019043','FABCO WELDING & MACHINE INC','','060019043','7516 E HWY 37','','TUTTLE','OK','730898301'
union all select '610608739','ERON CORP, THE','','610608739','28701 S HWY 125','','AFTON','OK','743312962'
union all select '061635082','PADGETT MACHINE SHOP, INC.','','061635082','1226 N 143RD E AVE','','TULSA','OK','741162120'
union all select '617360219','DUCOMMUN LABARGE TECHNOLOGIES, INC.','','617360219','11616 E 51ST ST','','TULSA','OK','741465911'
union all select '062264585','OIL FILTER CO INC','','062264585','1410 SW 3RD ST','','OKLAHOMA CITY','OK','731081414'
union all select '062273610','CARTER CHEVROLET AGENCY, L.L.C.','','062273610','214 W OKLAHOMA','','OKARCHE','OK','737629112'
union all select '624532826','HOLLAND SIGNAL INC','','624532826','1706 S MIRAMAR AVE','','INDIALANTIC','FL','329033529'
union all select '065445355','COPE PLASTICS, INC.','','065445355','310 NE 31ST ST','','OKLAHOMA CITY','OK','731052403'
union all select '065447252','CANNON & REFERMAT, L.L.C.','','065447252','4601 N WALNUT AVE','','OKLAHOMA CITY','OK','731052033'
union all select '070839501','B & B MEDICAL SERVICES INC.','','070839501','2236 NW 10TH ST STE 117','','OKLAHOMA CITY','OK','731075658'
union all select '007139199','NAVICO, INC.','','007139199','4500S 129TH E AVE STE200','','TULSA','OK','741345801'
union all select '007166812','DISAN ENGINEERING CORPORATION','','007166812','101 MOHAWK DR','','NOWATA','OK','740480000'
union all select '007188212','BENNETT, TOM MANUFACTURING','','007188212','18 NE 48TH ST','','OKLAHOMA CITY','OK','731052019'
union all select '007188352','CROWL MACHINE INC','','007188352','1632 NW 5TH ST','','OKLAHOMA CITY','OK','731065030'
union all select '007188857','CHICKASHA MANUFACTURING CO., INC.','','007188857','5501 HIGHWAY 81 S','','CHICKASHA','OK','730180000'
union all select '007191653','HIGH PRESSURE EQUIPMENT INC.','17338','007191653','7130 MELROSE LN','','OKLAHOMA CITY','OK','731276103'
union all select '007195035','INDUSTRIAL GASKET INC','','007195035','720 S SARA ROAD','','MUSTANG','OK','730644305'
union all select '007204738','FEDERAL CORPORATION','','007204738','120 E MAIN ST','','OKLAHOMA CITY','OK','731042491'
union all select '007205065','HUNZICKER BROTHERS, INC.','','007205065','501 N VIRGINIA AVE','','OKLAHOMA CITY','OK','731062638'
union all select '007207517','EVANS ENTERPRISES, INC.','','007207517','1536 S WESTERN AVE','','OKLAHOMA CITY','OK','731091422'
union all select '007221146','OIL CAPITAL VALVE COMPANY','','007221146','7400 E 42ND PL','','TULSA','OK','741454702'
union all select '007221773','CENTRIFUGAL CASTING MACHINE CO., INC.','11325','007221773','7744 NORTH OWASSO EXPY STE A','','OWASSO','OK','740553331'
union all select '007237241','THE BOEING COMPANY','','007237241','6001 S AIR DEPOT BLVD','','OKLAHOMA CITY','OK','731355922'
union all select '072422496','DRISCOLL AUTOMATIC CONTROL COMPANY INC','','072422496','5810 E SKELLY DR STE 705','','TULSA','OK','741356476'
union all select '074182366','GENISCO FILTER CORP.','','074182366','680 W BRADLEY AVE','','EL CAJON','CA','920201214'
union all select '074280983','NEWVIEW OKLAHOMA, INC.','','074280983','501 N DOUGLAS AVE','','OKLAHOMA CITY','OK','731065007'
union all select '076200344','THE BOEING COMPANY','','076200344','2600 WESTMINSTER AVE','','SEAL BEACH','CA','907400000'
union all select '078752449','CHEROKEE NATION RED WING LLC','','078752449','2777 HWY 69-A','','PRYOR','OK','743614565'
union all select '793042003','PRECISION FLUID POWER, INC','','793042003','1567 EXCHANGE AVE','','OKLAHOMA CITY','OK','731083016'
union all select '795771307','L-3 COMMUNICATIONS CORPORATION','','795771307','3724 W VANCOUVER ST','','BROKEN ARROW','OK','740122424'
union all select '079610750','NORTHROP GRUMMAN SYSTEMS CORPORATION','','079610750','6401 S AIR DEPOT BLVD','','OKLAHOMA CITY','OK','731355911'
union all select '080578982','HONEYWELL AEROSPACE TULSA/LORI','','080578982','6930 N LAKEWOOD AVE','','TULSA','OK','741171807'
union all select '080660867','VERTIPRIME GOVERNMENT SERVICES, LLC','7VUK2','080660867','230 W MAIN ST','','STRATFORD','OK','748720000'
union all select '080749370','POWER CABLE SOLUTIONS LLC','80AH3','080749370','832 COUNTY STREET 2920','','TUTTLE','OK','730893022'
union all select '828449160','CHEROKEE NATION AEROSPACE AND DEFENSE, L.L.C.','','828449160','RR 3 BOX 498','','STILWELL','OK','749609555'
union all select '829776975','CHEROKEE NATION RED WING, L.L.C.','','829776975','10838 E MARSHALL ST STE 200','','TULSA','OK','741165682'
union all select '830926312','JD SUPPLY & MFG','','830926312','5974 TRACY LN','','PIEDMONT','OK','730789048'
union all select '832217777','ADVANCED MACHINING SOLUTIONS, LLC','','832217777','4703 ENTERPRISE DRIVE, SUITE A','','OKLAHOMA CITY','OK','731281468'
union all select '843957650','GOVCON INC','','843957650','119 N ROBINSON STE 540','','OKLAHOMA CITY','OK','731024621'
union all select '877973933','BARON MANUFACTURING CO INC','','877973933','3100 W I 44 SERVICE RD','','OKLAHOMA CITY','OK','731126242'
union all select '091590703','FRONTIER ELECTRONIC SYSTEMS CORP.','','091590703','4500 W 6TH AVE','','STILLWATER','OK','740741522'
union all select '929236834','NORDAM GROUP, INC., THE','','929236834','7018 N LAKEWOOD AVE','','TULSA','OK','741171814'
union all select '932795586','JGB TECHNOLOGY, INC','','932795586','15208 GATEWAY GARDEN DR','','OKLAHOMA CITY','OK','731656733'
union all select '009531497','O & L RESOURCES, INC.','','009531497','400 E 1ST ST','','CHELSEA','OK','740162403'
union all select '969826267','ASES,LLC','','969826267','6015 S PORTLAND AVE','','OKLAHOMA CITY','OK','731592229'
union all select '098459357','IMAGENET CONSULTING, LLC','','098459357','913 N BROADWAY AVE','','OKLAHOMA CITY','OK','731025810'
union all select '098467715','MACHINE TOOL MARKETING, INC.','','098467715','21083 S. 103RD EAST AVE','','BIXBY','OK','740086734'
) v2 on v1.DUNSId = v2.DUNSId
END";

	}
}
